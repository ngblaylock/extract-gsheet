<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-VTXKH3E78Y"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());

  gtag("config", "G-VTXKH3E78Y");
</script>

 
<link rel="icon" href="/extract-gsheet/favicon.ico" type="image/x-icon" />

<link
  rel="apple-touch-icon"
  sizes="180x180"
  href="/extract-gsheet/apple-touch-icon.png"
/>
<link
  rel="icon"
  type="image/png"
  sizes="32x32"
  href="/extract-gsheet/favicon-32x32.png"
/>
<link
  rel="icon"
  type="image/png"
  sizes="16x16"
  href="/extract-gsheet/favicon-16x16.png"
/>
<link rel="manifest" href="/extract-gsheet/site.webmanifest" />
<link rel="mask-icon" href="/extract-gsheet/safari-pinned-tab.svg" color="#5bbad5" />
<meta name="msapplication-TileColor" content="#00641d" />
<meta name="theme-color" content="#ffffff" />
 
<title>Documentation | Extract GSheet</title>
<meta property="og:title" content="Documentation | Extract GSheet" />
 
<meta name="description" content="Learn about Extract GSheet features and how to quickly extract JSON data from a public Google Sheet." />
<meta property="og:description" content="Learn about Extract GSheet features and how to quickly extract JSON data from a public Google Sheet." />

<meta property="og:type" content="website" />
<meta property="og:url" content="https://ngblaylock.github.io/extract-gsheet/documentation/" />
<link rel="canonical" href="https://ngblaylock.github.io/extract-gsheet/documentation/" />
<meta property="og:image" content="https://ngblaylock.github.io/extract-gsheet/og-image.png" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css"
    />
    <link rel="stylesheet" href="/extract-gsheet/styles/egs.css" />
    
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-twilight.min.css"
      integrity="sha512-ch9ThmrGmkVrVm9tL/puGmSfzQps4yk9LDrWuswb65ZnPOIKuYZBen1yn3ez/fEbgeBqrU/IJ443OqgallfE9Q=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    
    <script src="/extract-gsheet/js/extract-gsheet.min.js"></script>
    
  </head>
  <body class="d-flex flex-column">
    <header><nav class="navbar navbar-expand-md navbar-dark bg-dark">
  <a class="navbar-brand" href="/extract-gsheet/"
    ><div class="d-flex justify-content-center align-items-center pl-3">
      <img
        src="/extract-gsheet/img/EGS-Logo-small-stroke.png"
        alt="Extract GSheet Logo"
      />
      <div class="h6 text-white p-0 my-0 mx-3">Extract GSheet</div>
    </div></a
  >
  <button
    class="navbar-toggler"
    type="button"
    data-toggle="collapse"
    data-target="#navbarNavDropdown"
    aria-controls="navbarNavDropdown"
    aria-expanded="false"
    aria-label="Toggle navigation"
  >
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNavDropdown">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item ">
        <a class="nav-link" href="/extract-gsheet/">Home</a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" href="/extract-gsheet/documentation/">Documentation</a>
      </li>
      <li class="nav-item dropdown ">
        <a
          class="nav-link dropdown-toggle"
          href="#"
          id="navbarDropdownMenuLink"
          role="button"
          data-toggle="dropdown"
          aria-expanded="false"
        >
          Examples
        </a>
        <div
          class="dropdown-menu dropdown-menu-right"
          aria-labelledby="navbarDropdownMenuLink"
        >
          <a class="dropdown-item" href="/extract-gsheet/examples/alpine/">Alpine</a>
          <a class="dropdown-item" href="/extract-gsheet/examples/angularjs/"
            >Angular.js</a
          >
          <a class="dropdown-item" href="/extract-gsheet/examples/handlebars/"
            >Handlebars</a
          >
          <a class="dropdown-item" href="/extract-gsheet/examples/jquery/">jQuery</a>
          <a class="dropdown-item" href="/extract-gsheet/examples/react/">React</a>
          <a class="dropdown-item" href="/extract-gsheet/examples/vue/">Vue</a>
        </div>
      </li>
      <li class="nav-item">
        <a
          class="nav-link"
          href="https://github.com/ngblaylock/extract-gsheet"
          target="_blank"
          rel="noopener"
          >GitHub <i class="fas fa-sm fa-external-link-alt"></i
        ></a>
      </li>
      <li class="nav-item">
        <a
          class="nav-link"
          href="https://www.npmjs.com/package/extract-gsheet"
          target="_blank"
          rel="noopener"
          >NPM <i class="fas fa-sm fa-external-link-alt"></i
        ></a>
      </li>
      
    </ul>
  </div>
</nav>
</header>
    <main class="egs py-3"><div class="container documentation">
<h1>Documentation</h1>
<h2>Features</h2>
<ul>
<li>Include the script and call <code>extractGSheet(&lt;published sheet url&gt;)</code></li>
<li>No API Keys required</li>
<li>Extracts all or single tabs in the published sheet</li>
<li>Transforms column headers into usable keys</li>
<li>Each table includes the title, name of the tab (if publishing multiple tabs), keys, and data values</li>
<li>Clears out columns without a column header (key)</li>
<li>Clears out empty rows</li>
<li>'TRUE' and 'FALSE' values are transformed to true and false (Boolean)</li>
<li>Checkboxes are transformed to true and false (Boolean)</li>
<li>Numbers are transformed to a numeric value (&quot;2.5&quot; is transformed to 2.5)</li>
<li>Preserves text formatting from the sheet ('$1.00' does not transform to '1')</li>
<li>If there is no &quot;ID&quot; column, a unique ID for the row will be provided.</li>
</ul>
<div class="alert alert-warning">
<h3>Warning</h3>
<ul>
<li>Extract GSheet will never reach v1.x.x. This is intended for small or personal projects. Make sure to use the version number in your script to avoid any potential breaking changes.</li>
<li>Extract GSheet heavily depends on the output HTML that Google provides. If Google's page changes a little bit, this script may break. Submit a new issue on GitHub if you find something was working but no longer is.</li>
<li>Most non-text features will not be included (images, charts, comments, etc.).</li>
<li>Some changes to a published sheet may take up to 5 minutes to reflect in the browser.</li>
<li>This will not natively work on Internet Explorer.</li>
<li>This version does not support server-side parsing as it relies on <code>fetch</code> and <code>DOMParser</code>. An enhancement for this is being considered.</li>
</ul>
</div>
<h2>Setup Google Sheet</h2>
<p>The first row in your Google Sheet will be the keys to your values (column headers). Some character transformations will occur in the JSON output:</p>
<ol>
<li>All characters will be made lowercase</li>
<li>Spaces and special characters will be replaced with an <code>_</code></li>
<li>Multiple spaces and/or special characters will be replaced with a single <code>_</code></li>
<li>Any key that begins with a number will be prefixed with an <code>_</code></li>
</ol>
<pre><code class="language-css">    Column Header    JSON Output
- - - - - - - - - - - - - - - - - - -
            HeLlO    hello
         Movie ID    movie_id
         Is True?    is_true_
           8 Keys    _8_keys
# of Participants    _of_participants
</code></pre>
<p><img src="/extract-gsheet/img/documentation/spreadsheet.png" alt="Google Sheet Screenshot"></p>
<p>Make sure that your Google Sheet has a title, and the tabs have names.</p>
<h2>Publish the Google Sheet</h2>
<p>In Google Sheets, go to <strong>File ➔ Share ➔ Publish to the web</strong>. Inside the dialog, you can choose to publish one tab, specific tabs, or the entire document.</p>
<p><strong>NOTE:</strong> If you have multiple tabs published, you will get the title of the tab separate from the document title. If you publish only one tab, the tab title will be returned included in the document title (probably separated by a <code>:</code>).</p>
<p>Once your tabs or document is selected, click &quot;Publish&quot; and you will be given a URL. Copy the entire URL. You will use the entire URL in your script.</p>
<p><img src="/extract-gsheet/img/documentation/publish-window.png" alt="Publish Sheet Dialog Screenshot"></p>
<h2>Load the Script</h2>
<p><strong>NPM:</strong> (This has not been thoroughly tested)</p>
<pre><code class="language-bash">npm install extract-gsheet@0.1.13
# Then in your file:
# import extractGSheet from 'extract-gsheet';
</code></pre>
<p><strong>CDN:</strong></p>
<pre><code class="language-html">&lt;script src=&quot;https://unpkg.com/extract-gsheet@0.1.13/dist/extract-gsheet.min.js&quot;&gt;&lt;/script&gt;
&lt;!-- OR --&gt;
&lt;script src=&quot;https://cdn.jsdelivr.net/npm/extract-gsheet@0.1.13/dist/extract-gsheet.min.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>Or download the JS from this <a href="https://github.com/ngblaylock/extract-gsheet/tree/master/dist" target="_blank">GitHub repo</a>.</p>
<h2>Use the Script</h2>
<p>Call the <code>extractGSheet()</code> function and pass in the entire URL from the published sheet. This script will return a promise, so you will probably want to use Async/Await or the <code>.then().catch()</code> syntax.</p>
<pre><code class="language-html">&lt;script&gt;
  extractGSheet(
    &quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vTRI47Ifj6D_US-HpggfPwSGU1nBSz81IaQ3FL3eqqjr2m8ZIdr6ia9L_FqsJqYVeUI_A2SDjm25FjG/pubhtml&quot;
  )
    .then((res) =&gt; {
      // res is the data object
      console.log(res);
    })
    .catch((err) =&gt; {
      // handle the error if there is one
      console.error(err);
    });
&lt;/script&gt;
</code></pre>
<p>That's it. Your data should be extracted from your published Google Sheet, and you can incorporate it into your website.</p>
<h2>Issue Reporting</h2>
<p>If you find a bug with this project, please report them on <a href="https://github.com/ngblaylock/extract-gsheet/issues">GitHub</a>. Pull requests are welcome.</p>
<h2>Special Thanks</h2>
<p>This project was heavily inspired by <a href="https://github.com/jsoma/tabletop">Tabletop.js by jsoma</a>. I used it in a lot of projects, but now that its time has passed, I decided to make my own script. I hope you find this project beneficial.</p>
</div>
</main>
    <footer class="bg-gradient-light mt-4">
  <div class="container py-3">
    <div class="d-flex justify-content-center align-items-center">
      <div class="d-flex align-items-center">
        <img
          src="https://nathanblaylock.com/images/logos/logo-black-nathan-blaylock-media.svg"
          alt="Nathan Blaylock Logo"
          style="height: 20px"
        />
      </div>
      <div class="px-3">&copy; Nathan Blaylock 2024</div>
      <div class="px-3">Last Updated: January 7, 2024</div>
      <div class="px-3">Version 0.1.13</div>
    </div>
  </div>
</footer>

    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
      integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
      crossorigin="anonymous"
    ></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
  </body>
</html>
