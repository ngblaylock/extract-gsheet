!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).extractGSheet=t()}(this,(function(){"use strict";const e=function(e){let t=[],n=[];return e.querySelectorAll("#sheets-viewport table").forEach((e=>{e.textContent&&t.push(e)})),t.forEach(((t,o)=>{let r=[],a=e.querySelectorAll("#sheet-menu li")[o];n.push({tab:a?a.textContent:"",keys:[],data:[]}),t.querySelectorAll("tr").forEach((e=>{e.textContent&&r.push(e)})),r[0].querySelectorAll("td").forEach((e=>{e.textContent&&n[o].keys.push({name:e.textContent,key:e.textContent.replace(/\W+/gi,"_").replace(/^\d/,"_$&").toLowerCase()})}));for(let e=0;e<r.length;e++)0!=e&&(n[o].data.push({}),r[e].querySelectorAll("td").forEach(((t,r)=>{if(n[o].keys[r]){let a=n[o].keys[r].key,l=t.textContent;l&&"true"===l.toLowerCase()?l=!0:l&&"false"===l.toLowerCase()&&(l=!1),a&&(n[o].data[e-1][a]=l)}})))})),n.forEach((e=>{e.data=e.data.filter((e=>!Object.values(e).every((e=>""===e))))})),n};return async function(t){let n=await async function(e){let t=await fetch(e);return await t.text()}(t).then((e=>e));var o=(new DOMParser).parseFromString(n,"text/html");return{title:o.querySelector("#doc-title .name").textContent,tables:e(o)}}}));
