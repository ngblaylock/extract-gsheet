var extractGSheet=function(){"use strict";async function e(e){let t=[];const r=e.matchAll(/items.push\({name: ([\s\S]*?), gid:\s/g);for(const e of r)if(e[1]){const r=e[1].split(", pageUrl: ");if(2===r.length){r[0]=r[0].slice(1,-1).trim(),r[1]=r[1].slice(1,-1).trim();const e=Function('return "'+r[1].replace(/"/g,'\\"')+'";')();t.push({tab:r[0],tableUrl:e})}}const a=t.map((e=>e.tableUrl)),n=await Promise.all(a.map((async(e,r)=>{const a=await fetch(e),n=await a.text(),o=(new DOMParser).parseFromString(n,"text/html");return{tab:t[r].tab,url:e,text:n,doc:o}})));return n.forEach((e=>{e.keys=[],e.data=[];e.doc.querySelector("table tbody").querySelectorAll("tr").forEach(((t,r)=>{const a=!![...t.querySelectorAll("td")].map((e=>e.innerText)).join("");if(0===r){t.querySelectorAll("td").forEach((t=>{e.keys.push({name:t.textContent,key:t.textContent.replace(/\W+/gi,"_").replace(/^\d/,"_$&").toLowerCase().trim()})}))}else if(a){const r={};t.querySelectorAll("td").forEach(((t,a)=>{const n=e.keys[a].key;if(n){let e=t.textContent.trim();e||(e=function(e){let t=e.innerHTML;return t.includes('<use href="#checked')?"true":t.includes('<use href="#unchecked')?"false":""}(t)),e&&"true"===e.toLowerCase()?e=!0:e&&"false"===e.toLowerCase()&&(e=!1),e&&"string"==typeof e&&!isNaN(e)&&(e=parseFloat(e)),r[n]=e}})),e.data.push(r)}})),delete e.doc,delete e.text,delete e.url,e.keys=e.keys.filter((e=>e.name))})),n.forEach((e=>{let t=!1;e.data.forEach(((r,a)=>{r.id||(t=!0,e.data[a]={id:a+1,...r})})),t&&e.keys.unshift({name:"ID",key:"id"})})),n}return async function(t){try{if(t.startsWith("https://docs.google.com/spreadsheets")){let r=await fetch(t),a=await r.text();return{title:(new DOMParser).parseFromString(a,"text/html").querySelector("#doc-title .name").textContent,tables:await e(a)}}throw"Invalid Public Google Sheet"}catch(e){throw new Error(e)}}}();
