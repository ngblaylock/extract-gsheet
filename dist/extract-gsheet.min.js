!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).extractGSheet=t()}(this,(function(){"use strict";const e=function(e){let t=e.innerHTML;return t.includes('<use href="#checkedCheckboxId"')?"true":t.includes('<use href="#uncheckedCheckboxId"')?"false":""},t=function(t){let n=[],r=[];return t.querySelectorAll("#sheets-viewport table").forEach((e=>{e.textContent&&n.push(e)})),n.forEach(((n,o)=>{let a=[],l=t.querySelectorAll("#sheet-menu li")[o];r.push({tab:l?l.textContent:"",keys:[],data:[]}),n.querySelectorAll("tr").forEach((e=>{(e.textContent||e.innerHTML.match(/<use href="#(un)?checkedCheckboxId"/g))&&a.push(e)})),a[0].querySelectorAll("td").forEach((e=>{e.textContent&&r[o].keys.push({name:e.textContent,key:e.textContent.replace(/\W+/gi,"_").replace(/^\d/,"_$&").toLowerCase()})}));for(let t=0;t<a.length;t++)0!=t&&(r[o].data.push({}),a[t].querySelectorAll("td").forEach(((n,a)=>{if(r[o].keys[a]){let l=r[o].keys[a].key;if(l){let a=n.textContent.trim();a||(a=e(n)),a&&"true"===a.toLowerCase()?a=!0:a&&"false"===a.toLowerCase()&&(a=!1),a&&"string"==typeof a&&!isNaN(a)&&(a=parseFloat(a)),r[o].data[t-1][l]=a}}})))})),r.forEach((e=>{e.data=e.data.filter((e=>!Object.values(e).every((e=>""===e))))})),r.forEach((e=>{e.data.forEach(((e,t)=>{e.id||(e.id=t+1)}))})),r};return async function(e){let n=await async function(e){let t=await fetch(e);return await t.text()}(e).then((e=>e));var r=(new DOMParser).parseFromString(n,"text/html");return{title:r.querySelector("#doc-title .name").textContent,tables:t(r)}}}));
